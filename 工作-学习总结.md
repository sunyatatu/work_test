# å·¥ä½œç¬”è®°

ä»£ç å®Œå…¨ä¸€æ ·çš„æ—¶å€™éœ€è¦è€ƒè™‘ç‰ˆæœ¬é—®é¢˜äº†ã€‚

## swagger

**æ³¨æ„ï¼šspring-boot 2.6.0æ²¡æœ‰é€‚é…swagger 2.9.2ï¼ˆå…¶å®ƒæœªçŸ¥ï¼‰,å› æ­¤å°†spring-bootç‰ˆæœ¬é™çº§ä¸º 2.5.7**

å·ç§°ä¸–ç•Œä¸Šæœ€æµè¡Œçš„Apiæ¡†æ¶

Restful Api æ–‡æ¡£åœ¨çº¿è‡ªåŠ¨ç”Ÿæˆå·¥å…·=ã€‹Apiæ–‡æ¡£ä¸APIå®šä¹‰åŒæ­¥æ›´æ–°

ç›´æ¥è¿è¡Œï¼Œå¯ä»¥åœ¨çº¿æµ‹è¯•APIå·¥å…·

æ”¯æŒå¤šç§è¯­è¨€ï¼ˆjavaã€phpï¼‰

+ è§£å†³æ–¹æ¡ˆï¼Œæ ‡å‡†è§„èŒƒ

+ ç”±è§„èŒƒå®šä¹‰æ¥å£åŠä¿¡æ¯

+ è°ƒç”¨ç«¯ä»£ç ã€æœåŠ¡ç«¯ä»£ç ä»¥åŠæ¥å£æ–‡æ¡£çš„ä¸€è‡´æ€§ã€‚

+ é€šè¿‡åœ¨é¡¹ç›®ä¸­å¼•å…¥Springfoxï¼Œå¯ä»¥æ‰«æç›¸å…³çš„ä»£ç ï¼Œç”Ÿæˆè¯¥æè¿°æ–‡ä»¶ï¼Œè¿›è€Œç”Ÿæˆä¸ä»£ç ä¸€è‡´çš„æ¥å£æ–‡æ¡£å’Œå®¢æˆ·ç«¯ä»£ç 

+ **Swagger Codegen**: 

  + å°†æè¿°æ–‡ä»¶ç”Ÿæˆhtmlæ ¼å¼å’Œcwikiå½¢å¼çš„æ¥å£æ–‡æ¡£
  + ä¹Ÿèƒ½ç”Ÿæˆå¤šç§è¯­è¨€çš„æœåŠ¡ç«¯å’Œå®¢æˆ·ç«¯çš„ä»£ç 

+ **Swagger UI**:

  æä¾›äº†å¯è§†åŒ–çš„UIé¡µé¢å±•ç¤ºæè¿°æ–‡ä»¶ã€‚ç›¸å…³æ¥å£æŸ¥é˜… å’Œ æ¥å£è¯·æ±‚ã€‚æ”¯æŒåœ¨çº¿å¯¼å…¥æè¿°æ–‡ä»¶å’Œæœ¬åœ°éƒ¨ç½²UIé¡¹ç›®ã€‚

+ **Swagger Editor**: 

  ç±»ä¼¼äºmarkendownï¼Œç¼–è¾‘Swaggeræè¿°æ–‡ä»¶çš„ç¼–è¾‘å™¨ï¼Œæ”¯æŒå®æ—¶é¢„è§ˆæè¿°æ–‡ä»¶çš„æ›´æ–°æ•ˆæœã€‚æä¾›åœ¨çº¿ç¼–è¾‘å™¨å’Œæœ¬åœ°éƒ¨ç½²ç¼–è¾‘å™¨ä¸¤ç§æ–¹å¼ã€‚

+ **Swagger Inspector**: 

  ç±»ä¼¼postmanï¼Œå¯å¯¹æ¥å£è¿›è¡Œæµ‹è¯•çš„åœ¨çº¿ç‰ˆçš„postmanã€‚æ¯”åœ¨Swagger UIé‡Œé¢åšæ¥å£è¯·æ±‚ï¼Œä¼šè¿”å›æ›´å¤šçš„ä¿¡æ¯ï¼Œä¼šä¿å­˜ä½ è¯·æ±‚çš„å®é™…è¯·æ±‚å‚æ•°ç­‰æ•°æ®ã€‚

+ **Swagger Hub**ï¼šé›†æˆäº†ä¸Šé¢æ‰€æœ‰é¡¹ç›®çš„å„ä¸ªåŠŸèƒ½ï¼Œå¯ ä»¥é¡¹ç›®å’Œç‰ˆæœ¬ä¸ºå•ä½ï¼Œå°†æè¿°æ–‡ä»¶ä¸Šä¼ åˆ°Swagger Hubä¸­ã€‚åœ¨Swagger Hubä¸­å¯ä»¥å®Œæˆä¸Šé¢é¡¹ç›®çš„æ‰€æœ‰å·¥ä½œï¼Œéœ€è¦æ³¨å†Œè´¦å·ï¼Œåˆ†å…è´¹ç‰ˆå’Œæ”¶è´¹ç‰ˆ

+ **Springfox Swagger**: 

  Spring åŸºäºswaggerè§„èŒƒï¼Œå¯ä»¥å°†åŸºäºSpringMVCå’ŒSpring Booté¡¹ç›®çš„é¡¹ç›®ä»£ç ï¼Œè‡ªåŠ¨ç”ŸæˆJSONæ ¼å¼çš„æè¿°æ–‡ä»¶

### æµç¨‹

+ å¯¼åŒ…

  ```xml
  <!-- https://mvnrepository.com/artifact/io.springfox/springfox-swagger2 -->
  <dependency>
      <groupId>io.springfox</groupId>
      <artifactId>springfox-swagger2</artifactId>
      <version>2.9.2</version>
  </dependency>
  <!-- https://mvnrepository.com/artifact/io.springfox/springfox-swagger-ui -->
  <dependency>
      <groupId>io.springfox</groupId>
      <artifactId>springfox-swagger-ui</artifactId>
      <version>2.9.2</version>
  </dependency>
  <!-- https://mvnrepository.com/artifact/com.github.xiaoymin/swagger-bootstrap-ui -->
  <dependency>
      <groupId>com.github.xiaoymin</groupId>
      <artifactId>swagger-bootstrap-ui</artifactId>
      <version>1.8.7</version>
  </dependency>
  
  ```

+ ç¼–å†™helloWorldå·¥ç¨‹

+ é…ç½®swagger

  ç¼–å†™ä¸€ä¸ªconfigåŒ…ï¼ŒåŒ…ä¸‹ç¼–å†™swaggerçš„é…ç½®

   

  ```java
  @Configuration
  @EnableSwagger2
  public class SwaggerConfig {
  }
  ```

+ æµ‹è¯•è¿è¡Œ

### æ³¨è§£ç”¨ä¾‹

```java
@ApiModel("Student")//å®ä½“ç±»
@ApiModelProperty("å­¦ç”Ÿid")//å®ä½“å±æ€§
@Api(value = "StudentController",tags = "å­¦ç”Ÿæ§åˆ¶å™¨")
@ApiOperation(value = "æµ‹è¯•rediså­˜å‚¨å¯¹è±¡",notes = "rediså­˜å‚¨å¯¹è±¡")
//å±æ€§æ ‡è®°   
@ApiImplicitParams({
    @ApiImplicitParam(name = "",value = "",paramType = "",type = "",required = true),
    @ApiImplicitParam(...),
    @ApiImplicitParam(...)
})

```

## mybatis-plus 3.0

**æ³¨æ„åœ¨å…¥å£æ·»åŠ æ‰«æåŒ…çš„ä¿¡æ¯**

### å¯¼åŒ…

```xml
<!-- https://mvnrepository.com/artifact/com.baomidou/mybatis-plus-boot-starter -->
<dependency>
    <groupId>com.baomidou</groupId>
    <artifactId>mybatis-plus-boot-starter</artifactId>
    <version>3.2.0</version>
</dependency>

<!-- https://mvnrepository.com/artifact/com.baomidou/mybatis-plus-generator -->
<dependency>
    <groupId>com.baomidou</groupId>
    <artifactId>mybatis-plus-generator</artifactId>
    <version>3.2.0</version>
</dependency>
```

### æšä¸¾

æ³¨è§£æ–¹å¼ï¼š

+ `@EnumValue`

+ ```yml
  type-enums-package: com.songxian.projectDemo.myenum
  ```

æ¥å£æ–¹å¼ï¼š

`implement IEnum`

ä¸ç”¨`@EnumValue`æ³¨è§£äº†

### åˆ†é¡µ

**é…ç½®åˆ†é¡µæ‹¦æˆªå™¨**ï¼ˆå¦åˆ™åˆ†é¡µä¼šå¤±æ•ˆï¼‰

```java
@Configuration
public class MyBatisPlusConfig {

    @Bean
    public PaginationInterceptor   paginationInterceptor(){
        return new PaginationInterceptor();
    }
}
```

### å†™mapperæ¥å£

+ æ¥å£ç»§æ‰¿`BaseMapper`

### è‡ªåŠ¨ç”Ÿæˆï¼ˆæ ¹æ®åº“ç”Ÿæˆå®ä½“ç±»ï¼‰

1. pom.xmlå¯¼å…¥ä¾èµ–

   ```xml
   <dependency>
       <groupId>com.baomidou</groupId>
       <artifactId>mybatis-plus-generator</artifactId>
       <version>3.2.0</version>
   </dependency>
   ```

   æ³¨ï¼šVelocity(é»˜è®¤)ã€freemarkerã€Beetlä¸‰ä¸ªmybatis-plusè‡ªåŠ¨ç”Ÿæˆçš„æ¨¡æ¿(ç­–ç•¥)é€‰å…¶ä¸­ä¸€ä¸ªå³å¯ã€‚

   ```xml
   <dependency>
       <groupId>org.springframework.boot</groupId>
       <artifactId>spring-boot-starter-freemarker</artifactId>
       <version>2.4.2</version>
   </dependency>
   ```

   

2. 

## application.yml

+ **å¼€å‘ç¯å¢ƒï¼š**

  ç”¨äºå¼€å‘çš„æœåŠ¡å™¨ï¼Œé…ç½®å¯éšæ„ï¼Œ ä¸ºå¼€å‘è°ƒè¯•æ–¹ä¾¿ï¼Œä¸€èˆ¬æ‰“å¼€å…¨éƒ¨é”™è¯¯æŠ¥å‘Šã€‚

  é¡¹ç›®å°šåœ¨ç¼–ç é˜¶æ®µï¼Œä»£ç ä¸€èˆ¬åœ¨å¼€å‘ç¯å¢ƒä¸­ï¼Œä¸ä¼šåœ¨ç”Ÿäº§ç¯å¢ƒä¸­ï¼Œç”Ÿäº§ç¯å¢ƒç»„æˆï¼šæ“ä½œç³»ç»Ÿ ï¼ŒwebæœåŠ¡å™¨ ï¼Œè¯­è¨€ç¯å¢ƒã€‚

+ **æµ‹è¯•ç¯å¢ƒï¼š**

  ä¸€èˆ¬å…‹éš†ä¸€ä»½ç”Ÿäº§ç¯å¢ƒçš„é…ç½®ï¼Œä¸€ä¸ªç¨‹åºåœ¨æµ‹è¯•ç¯å¢ƒå·¥ä½œä¸æ­£å¸¸ï¼Œé‚£ä¹ˆè‚¯å®šä¸èƒ½æŠŠå®ƒå‘å¸ƒåˆ°ç”Ÿäº§æœºä¸Šã€‚é€šå¸¸æŒ‡é¡¹ç›®æµ‹è¯•ï¼Œ**ä¿®æ”¹bugé˜¶æ®µ**ã€‚

+ **ç”Ÿäº§ç¯å¢ƒï¼š**

  æŒ‡æ­£å¼æä¾›å¯¹å¤–æœåŠ¡çš„ï¼Œä¸€èˆ¬å…³æ‰é”™è¯¯æŠ¥å‘Šï¼Œæ‰“å¼€é”™è¯¯æ—¥å¿—ã€‚

  é¡¹ç›®æ•°æ®å‰ç«¯åå°å·²ç»è·‘é€šï¼Œ**éƒ¨ç½²åœ¨æœåŠ¡å™¨ä¸Šä¹‹åï¼Œæœ‰å®¢æˆ·ä½¿ç”¨ï¼Œè®¿é—®ï¼Œå°±æ˜¯ç½‘ç«™æ­£å¼è¿è¡Œ**äº†ã€‚

+ **UATç¯å¢ƒï¼š**

  UATï¼Œ(User Acceptance Test)ï¼Œç”¨æˆ·æ¥å—åº¦æµ‹è¯• å³éªŒæ”¶æµ‹è¯•ï¼Œæ‰€ä»¥UATç¯å¢ƒä¸»è¦æ˜¯ç”¨æ¥ä½œä¸ºå®¢æˆ·ä½“éªŒçš„ç¯å¢ƒã€‚

+ **ä»¿çœŸç¯å¢ƒï¼š**

  å’ŒçœŸæ­£ä½¿ç”¨çš„ç¯å¢ƒä¸€æ ·çš„ç¯å¢ƒï¼ˆå³å·²ç»å‡ºå”®ç»™å®¢æˆ·çš„ç³»ç»Ÿæ‰€åœ¨ç¯å¢ƒï¼Œä¹Ÿæˆä¸ºå•†ç”¨ç¯å¢ƒï¼‰ï¼Œæ‰€æœ‰çš„é…ç½®ï¼Œé¡µé¢å±•ç¤ºç­‰éƒ½åº”è¯¥å’Œå•†å®¶æ­£åœ¨ä½¿ç”¨çš„ä¸€æ ·ï¼Œå·®åˆ«åªåœ¨ç¯å¢ƒçš„æ€§èƒ½æ–¹é¢ã€‚

  

  ç³»ç»Ÿå†…éƒ¨é›†æˆæµ‹è¯•(System Integration Testing) ï¼šSIT
  ç”¨æˆ·éªŒæ”¶æµ‹è¯•(User Acceptance Testing) ï¼šUAT
  SITåœ¨å‰ï¼ŒUATåœ¨åï¼ŒUATæµ‹å®Œæ‰å¯ä»¥ä¸Šçº¿ã€‚
  SITæ˜¯é›†æˆæµ‹è¯•ï¼ŒUATæ˜¯éªŒæ”¶æµ‹è¯•ã€‚ä»æ—¶é—´ä¸Šçœ‹ï¼ŒUATè¦åœ¨SITåé¢ï¼ŒUATæµ‹è¯•è¦åœ¨ç³»ç»Ÿæµ‹è¯•å®Œæˆåæ‰å¼€å§‹ã€‚ä»æµ‹è¯•äººå‘˜çœ‹ï¼ŒSITç”±å…¬å¸çš„æµ‹è¯•å‘˜æ¥æµ‹è¯•ï¼Œè€ŒUATä¸€èˆ¬æ˜¯ç”±ç”¨æˆ·æ¥æµ‹è¯•ã€‚

## æ—¥å¿—æ¡¥æ¥

## spring-boot

### VO

è¿”å›ç»™è§†å›¾ï¼ŒæŠŠå‰ç«¯éœ€è¦çš„å­—æ®µæåˆ°VOï¼Œè€Œä¸ç”¨å§æ‰€æœ‰æŸ¥è¯¢åˆ°çš„å­—æ®µéƒ½æä¾›ç»™å‰ç«¯

### dtoï¼ˆdata to objectï¼‰

ä»æ•°æ®åº“æ¥åˆ°ä¸šåŠ¡å±‚



## Hutool

Hutoolçš„å­˜åœ¨å°±æ˜¯ä¸ºäº†å‡å°‘ä»£ç æœç´¢æˆæœ¬ï¼Œé¿å…ç½‘ç»œä¸Šå‚å·®ä¸é½çš„ä»£ç å‡ºç°å¯¼è‡´çš„bug.

ä½¿ç”¨ä¸€ä¸ªå·¥å…·æ–¹æ³•ä»£æ›¿ä¸€æ®µå¤æ‚ä»£ç 

- ğŸ‘´ã€ä»¥å‰ã€‘æ‰“å¼€æœç´¢å¼•æ“ -> æœâ€œJava MD5åŠ å¯†â€ -> æ‰“å¼€æŸç¯‡åšå®¢-> å¤åˆ¶ç²˜è´´ -> æ”¹æ”¹å¥½ç”¨
- ğŸ‘¦ã€ç°åœ¨ã€‘å¼•å…¥Hutool -> SecureUtil.md5()

å¯ä»¥æ ¹æ®éœ€æ±‚å¯¹æ¯ä¸ªæ¨¡å—å•ç‹¬å¼•å…¥ï¼Œä¹Ÿå¯ä»¥é€šè¿‡å¼•å…¥`hutool-all`æ–¹å¼å¼•å…¥æ‰€æœ‰æ¨¡å—ã€‚

```xml
<dependency>
    <groupId>cn.hutool</groupId>
    <artifactId>hutool-all</artifactId>
    <version>5.7.10</version>
</dependency>
```



## mysql

### æ•°æ®åº“å¤‡ä»½ä¸æ¢å¤

å¤‡ä»½ï¼š

`mysqldump -u root -p -B æ•°æ®åº“å > å¯¼å…¥çš„è·¯å¾„ä»¥åŠæ–‡ä»¶å.sql`

å¦‚æœåªæ˜¯å¤‡ä»½æŸä¸€ä¸ªæˆ–è€…å‡ ä¸ªè¡¨ï¼Œåªéœ€è¦`-B`å»æ‰ï¼Œç¬¬ä¸€ä¸ªå‚æ•°æ˜¯æ•°æ®åº“ï¼Œåé¢çš„å‚æ•°éƒ½æ˜¯è¡¨ã€‚

æ¢å¤ï¼š

`source å¯¼å…¥çš„è·¯å¾„ä»¥åŠæ–‡ä»¶å.sql`ï¼Œå¦‚`source d:\\a.sql`

## spring-bootæ•´åˆæŠ€æœ¯

### æ•´åˆmubatis-plus

## shiro

**å®‰å…¨æ¡†æ¶**ï¼Œä¸ä¾èµ–å®¹å™¨ï¼Œä¸»è¦å¯¹è®¿é—®ç³»ç»Ÿçš„ç”¨æˆ·èº«ä»½éªŒè¯ï¼Œæˆæƒã€ä¼šè¯ç®¡ç†ã€åŠ å¯†ç­‰

### shiroæ ¸å¿ƒç»„ä»¶

ç”¨æˆ·ã€è§’è‰²ã€æƒé™

ä¸€èˆ¬è§’è‰²èµ‹äºˆæƒé™ï¼Œç»™ç”¨æˆ·èµ‹äºˆè§’è‰²

å…ˆè®¤è¯å†æˆæƒ

1. UsernamePasswordTokenï¼Œå¯¹ç”¨æˆ·è¾“å…¥ä¿¡æ¯å°è£…ï¼Œç„¶ååˆ°æ•°æ®åº“é‡ŒæŸ¥è¯¢ï¼Œä½¿ç”¨ç”¨æˆ·ä¿¡æ¯æ¥åˆ›å»ºtoken

2. SecurityManagerï¼Œshiroçš„æ ¸å¿ƒéƒ¨åˆ†ï¼Œ**è´Ÿè´£å®‰å…¨è®¤è¯å’Œæˆæƒ**

3. subjectï¼Œshiroçš„æŠ½è±¡æ¦‚å¿µï¼ŒåŒ…å«ç”¨æˆ·ä¿¡æ¯ï¼Œç”¨æ¥**éªŒè¯ç”¨æˆ·ä¿¡æ¯**

4. **Realmï¼Œå¼€å‘è€…è‡ªå®šä¹‰çš„ä¸œè¥¿ï¼Œæ ¹æ®é¡¹ç›®éœ€æ±‚ï¼ŒéªŒè¯å’Œæˆæƒé€»è¾‘éƒ½åœ¨å†™åœ¨é‡Œé¢**

5. AuthenticationInfoï¼Œç”¨æˆ·è§’è‰²ä¿¡æ¯é›†åˆï¼Œè®¤è¯æ—¶ä½¿ç”¨

6. AuthorzationInfoï¼Œè§’è‰²çš„æƒé™ä¿¡æ¯ï¼Œæˆæƒæ—¶ä½¿ç”¨

7. DefaultWebSecurityManagerï¼Œå®‰å…¨ç®¡ç†æ¡†æ¶ï¼ŒReamléœ€è¦æ³¨å…¥åˆ°é‡Œé¢æ‰èƒ½ç”Ÿæ•ˆ

8. ShiroFilterFactoryBeanï¼Œè¿‡æ»¤å™¨å·¥å‚ ï¼Œå…·ä½“æ‰§è¡Œçš„æ“ä½œç”±æ­¤åˆ›å»ºçš„ä¸€ä¸ªä¸ªFilterå¯¹è±¡æ¥å®Œæˆ

   <img src="C:\Users\Chang\AppData\Roaming\Typora\typora-user-images\image-20211125101653273.png" alt="image-20211125101653273" style="zoom: 50%;" />

   **shiroçš„è¿è¡Œæœºåˆ¶**

   ![image-20211125101950401](C:\Users\Chang\AppData\Roaming\Typora\typora-user-images\image-20211125101950401.png)

## Quartz(å®šæ—¶ä»»åŠ¡)

æ˜¯ä¸€ä¸ª**ç”¨æˆ·è°ƒåº¦æ¡†æ¶**ï¼Œç”¨æˆ·è°ƒåº¦ç°åœºï¼šTimeråšä¸åˆ°ã€‚**ä»»åŠ¡è°ƒåº¦ç°åœºä¸ä¸¢å¤±**

+ å¼ºå¤§çš„è°ƒåº¦åŠŸèƒ½
+ çµæ´»çš„åº”ç”¨æ–¹å¼
+ åˆ†å¸ƒå¼åŠé›†ç¾¤èƒ½åŠ›

è®¾è®¡æ¨¡å¼:

+ Builderæ¨¡å¼
+ Factoryæ¨¡å¼
+ ç»„ä»¶æ¨¡å¼
+ é“¾å¼å†™æ³•

æ ¸å¿ƒæ¦‚å¿µ

+ è°ƒåº¦å™¨
+ ä»»åŠ¡
+ è§¦å‘å™¨

### JobDetail

åŒ…å«ä»»åŠ¡å®ç°ç±»åŠç±»çš„ä¿¡æ¯

### Trigger

å†³å®šä»»åŠ¡ä»€ä¹ˆæ—¶å€™è¢«è°ƒç”¨

+ SimpleThrigger

  æ‰§è¡Œç±»ä¼¼Timerå®ç°ä¸Šé¢çš„æ“ä½œï¼Œå¦‚å®šé¢‘ç‡çš„å»æ‰§è¡ŒæŸä¸ªcase

  åœ¨ä¸€ä¸ªæŒ‡å®šæ—¶é—´æ®µå†…æ‰§è¡Œä¸€æ¬¡ä½œä¸šä»»åŠ¡æˆ–è€…æ˜¯åœ¨æŒ‡å®šæ—¶é—´é—´éš”å†…å¤šæ¬¡æ‰§è¡Œä½œä¸šä»»åŠ¡

  <img src="C:\Users\Chang\AppData\Roaming\Typora\typora-user-images\image-20211129110354948.png" alt="image-20211129110354948" style="zoom: 33%;" />

+ **CronTrigger**ï¼ˆå¸¸ç”¨ï¼‰

  æ‰§è¡Œæ›´å¤æ‚çš„ä¸šåŠ¡é€»è¾‘ï¼Œå¦‚éœ€è¦ä»»åŠ¡æ¯å‘¨äº”æ‰§è¡Œä¸€æ¬¡

  åŸºäºæ—¥å†çš„è°ƒåº¦å™¨ï¼Œè€Œä¸æ˜¯åƒSimpleTriggeré‚£æ ·ç²¾ç¡®çš„æŒ‡å®šé—´éš”æ—¶é—´

  æ ¼å¼ï¼š

  `ç§’ åˆ† æ—¶ æ—¥ æœˆ å‘¨ å¹´`   7ä¸ªè¡¨è¾¾å¼

  + Lå’ŒWå¯ä»¥ä¸€èµ·ç»„åˆä½¿ç”¨ï¼Œå¦‚æ¯æœˆçš„æœ€åä¸€ä¸ªå·¥ä½œæ—¥ï¼ˆæ¯”å¦‚å‘å·¥èµ„ï¼‰
  + å¦‚æœä¸ä¼šåˆ™å»ç½‘ä¸Šæ‰¾cronåœ¨çº¿ç”Ÿæˆå™¨

  ![image-20211129113125233](C:\Users\Chang\AppData\Roaming\Typora\typora-user-images\image-20211129113125233.png)

é€šç”¨å±æ€§ï¼š

+ JobKey

  è¡¨ç¤ºJobå®ä¾‹çš„æ ‡è¯†ï¼Œè§¦å‘å™¨è¢«æ‰§è¡Œæ—¶ï¼Œè¯¥æŒ‡å®šçš„Jobå®ä¾‹ä¼šæ‰§è¡Œ

+ StartTime

  è¡¨ç¤ºè§¦å‘å™¨çš„æ—¶é—´è¡¨é¦–æ¬¡è¢«è§¦å‘çš„æ—¶é—´ï¼ˆjava.util.Dateï¼‰

+ endTime

  æŒ‡å®šè§¦å‘å™¨ä¸å†è¢«è§¦å‘çš„æ—¶é—´ï¼ˆjava.util.Dateï¼‰

### schedulerï¼ˆè°ƒåº¦å™¨ï¼‰

å®šæ—¶å®šé¢‘ç‡çš„å»æ‰§è¡ŒJobDetailçš„ä¿¡æ¯ï¼Œå¹¶å°†JobDetailå’ŒTriggerç»‘å®šåœ¨äº†ä¸€èµ·ï¼Œè°ƒç”¨ä¸€äº›æ–¹æ³•å»æ‰§è¡Œä»»åŠ¡

![image-20211129090849680](C:\Users\Chang\AppData\Roaming\Typora\typora-user-images\image-20211129090849680.png)

### é‡è¦ç»„æˆ

+ Jobï¼ˆæ¥å£ï¼‰

  åªæœ‰ä¸€ä¸ªæ–¹æ³•ï¼Œå¯å®ç°è¯¥æ¥å£**å®šä¹‰è¿è¡Œä»»åŠ¡**ï¼Œå‚æ•°JobExecutionContextä¸ºè°ƒåº¦ä¸Šä¸‹æ–‡çš„å‚æ•°ä¿¡æ¯ï¼ˆJobè¿è¡Œæ—¶çš„ä¿¡æ¯ï¼‰,é€šè¿‡JobExecutionContextè·å–åˆ°Jobä¿¡æ¯æˆ–è€…Triggerä¿¡æ¯

  ```java
  @Override
      public void execute(JobExecutionContext jobExecutionContext) throws JobExecutionException {...}
  ```

  ```java
  jobExecutionContext.getMergedJobDataMap()
  åˆå¹¶JobDataMapï¼Œå½“keyç›¸åŒæ—¶ï¼Œä¼˜å…ˆTriggerçš„å±æ€§
  ```

  ```java
  JobDetail jobDetail = JobBuilder.newJob(HelloJob.class)
          .withIdentity("myJob", "group1")
          .usingJobData("message","hello myjob1")
          .usingJobData("floatJobValue",3.14F)
          .build();
  ```

  ```java
  Trigger trigger = TriggerBuilder.newTrigger()
          .withIdentity("myTrigger", "group1")
          .usingJobData("message","hello my trigger")
          .usingJobData("doubleTriggerValue",2.0D)
          .startNow()
          .withSchedule(SimpleScheduleBuilder.simpleSchedule()
          .withIntervalInSeconds(2)
          .repeatForever())
          .build();
  ```

  å®ç°ä¸šåŠ¡é€»è¾‘çš„ä»»åŠ¡æ¥å£

+ JobDetail

  é™å®šäº†åªèƒ½æ˜¯Jobå®ä¾‹ï¼Œå‚æ•°nameï¼Œgroupï¼ŒjobClassï¼ŒjobDataMap

+ JobBuilder

  å®šä¹‰æˆ–è€…åˆ›å»ºJobçš„å®ä¾‹

+ JobStoreï¼ˆæ¥å£ï¼‰

   ç”¨æ¥ä¿å­˜Jobæ•°æ®

+ Trigger

  æè¿°Jobæ‰§è¡Œè§¦å‘è§„åˆ™

+ TriggerBuilder

  å®šä¹‰æˆ–åˆ›å»ºè§¦å‘å™¨å®ä¾‹

+ ThreadPool

  çº¿ç¨‹æ± ï¼Œä»»åŠ¡è¿è¡Œçš„åŸºç¡€è®¾æ–½ï¼Œå…±äº«ç”¨æˆ·çº¿ç¨‹æ± ï¼Œæé«˜è¿è¡Œæ•ˆç‡

+ scheduler

  ä»£è¡¨Cronç‹¬ç«‹è¿è¡Œå®¹å™¨ï¼ŒTriggerå’ŒJobDetailå¯ä»¥æ³¨å†Œåˆ°å…¶ä¸­

+ Calendar

  ä¸€ä¸ªTriggerå¯å’Œå¤šä¸ªCalendarå…³è”ï¼Œä»¥æ’é™¤æˆ–åŒ…å«æŸä¸ªæ—¶é—´ç‚¹

+ ç›‘å¬å™¨

  JobListenerï¼ŒTriggerListenerï¼ŒSchedulerListenerã€‚

### è·å–JobDataMapçš„ä¸¤ç§æ–¹å¼

+ ä»Mapä¸­è·å–

  ```java
  //1ã€è·å–JobDetailçš„Map
  JobDataMap jobDataMap = jobExecutionContext.getJobDetail().getJobDataMap();
  String jobMsg = jobDataMap.getString("message");
  float floatJobValue = jobDataMap.getFloat("floatJobValue");
  //2ã€è·å–Triggerçš„Map
  JobDataMap triggerJobDataMap = jobExecutionContext.getTrigger().getJobDataMap();
  String triggerMsg = triggerJobDataMap.getString("message");
  double doubleTriggerValue = triggerJobDataMap.getDouble("doubleTriggerValue");
  ```

+ Jobå®ç°ç±»ä¸­æ·»åŠ setteræ–¹æ³•å¯¹åº”çš„JobDataMapçš„é”®å€¼ï¼ˆJobFactoryé»˜è®¤çš„å®ç°ç±»åˆå§‹åŒ–æ—¶jobå®ä¾‹å¯¹è±¡æ—¶ä¼šè‡ªåŠ¨è°ƒç”¨è¿™äº›setteræ–¹æ³•ï¼‰

### æ–‡æ¡£åŠ è½½é¡ºåº

Quartzä¼šä¼˜å…ˆè¯»å–é¡¹ç›®ç›®å½•ä¸‹çš„åä¸º`quartz.properties`çš„é…ç½®æ–‡ä»¶ï¼Œè‹¥æ²¡æœ‰ï¼Œå°±ä¼šè¯»å–jaråŒ…é‡Œçš„`quartz.properties`

#### quartz.propertiesç»„æˆéƒ¨åˆ†

1. è°ƒåº¦å™¨å±æ€§

   1. ```properties
      org.quartz.scheduler.instanceName: DefaultQuartzScheduler
      org.quartz.scheduler.instanceId:
      #æ˜¯å¦æ”¯æŒè¿œç¨‹è°ƒç”¨
      org.quartz.scheduler.rmi.export: false
      org.quartz.scheduler.rmi.proxy: false
      ```

      ç”¨æ¥åŒºåˆ†ç‰¹å®šçš„è°ƒåº¦å™¨å®ä¾‹ï¼Œå¯å®‰å·åŠŸèƒ½ç”¨é€”æ¥ç»™è°ƒåº¦å™¨èµ·å,instanceNameé€»è¾‘å±‚é¢ï¼ŒinstanceIdç‰©ç†å±‚é¢ï¼Œå”¯ä¸€æ€§

2. ä½œä¸šå­˜å‚¨è®¾ç½®

   1. æè¿°äº†åœ¨è°ƒåº¦å™¨å®ä¾‹çš„ç”Ÿå‘½å‘¨æœŸä¸­ï¼ŒJobå’ŒTriggerä¿¡æ¯æ—¶å¦‚ä½•å­˜å‚¨çš„ã€‚ï¼ˆä¿å­˜åœ¨å†…å­˜ï¼Ÿè¿˜æ˜¯DBï¼Ÿå“ªç§DBï¼‰

3. çº¿ç¨‹æ± å±æ€§

4. æ’ä»¶é…ç½®

   1. æ»¡è¶³ç‰¹å®šéœ€æ±‚ç”¨åˆ°çš„Quartzæ’ä»¶çš„é…ç½®

## ç¼“å­˜

### ç¼“å­˜åˆ†ç±»

1. å•æœºç¼“å­˜

   å¦‚ehcacheï¼Œguava cache

2. åˆ†å¸ƒå¼ç¼“å­˜

   å¦‚redis

## ehcache

CacheManager:ç”¨æ¥ç®¡ç†å¤šä¸ªcacheï¼Œuser_cache,item_cache,store_cache

String[] cacheNames = cacheManager.create(absPath) ï¼šè·å–åˆ°cacheManagerç®¡ç†çš„æ‰€æœ‰cache

Cache userCache = cacheNames.getCache("user_cache")ï¼šè·å–å…·ä½“çš„cache

å¾€user_cacheä¸­æ”¾å…¥ä¸€ä¸ªuserå¯¹è±¡

Element element = new Element(user.getId(),user);

userCache.put(element);

//é€šè¿‡keyå–å‡ºç¼“å­˜

Element resultEle =  userCache.get(1L);

ç„¶åé€šè¿‡getObjectValue()è·å–å¯¹è±¡

## Redis

åŸºäºå†…å­˜ï¼Œæ”¯æŒkey-valueï¼Œåº•å±‚cè¯­è¨€ï¼Œæ— è¡¨æ¦‚å¿µ

æ”¯æŒ5ç§æ•°æ®ç±»å‹ï¼š

+ å­—ç¬¦ä¸²

  + å¯¹è±¡æˆ–è€…å­—ç¬¦ä¸²éƒ½æ˜¯ç”¨opsForValue()

+ åˆ—è¡¨

  ```java
   @GetMapping("/list")
      public List<String> listTest(){
          ListOperations<String,String> listOperations = redisTemplate.opsForList();
          listOperations.leftPush("list", "Hello");
          listOperations.leftPush("list", "World");
          listOperations.leftPush("list", "java");
          listOperations.leftPush("list", "!");
  //        å‚æ•°2 3è¡¨ç¤ºä¸‹æ ‡ï¼Œéƒ½åŒ…å«åˆ°
          List<String> list = listOperations.range("list", 0, 2);
          return list;
      }
  ```

+ é›†åˆ

  ```java
  @GetMapping("/set")
  public Set<String> setTest(){
      SetOperations<String> setOperations = redisTemplate.opsForSet();
      setOperations.add("set", "Hello");
      setOperations.add("set", "zhangsan");
      setOperations.add("set", "Hello");
      Set<String> set = setOperations.members("set");
      return set;
  } 
  ```

+ æœ‰åºé›†åˆ

  ```java
  @GetMapping("/zset")
  @ApiOperation(value = "zsetæµ‹è¯•",tags = "zsetæµ‹è¯•å™¢")
  public Set<String> zsetTest(){
      ZSetOperations<String,String> zSetOperations = redisTemplate.opsForZSet();
      zSetOperations.add("zset", "å¼ ä¸‰",1);
      zSetOperations.add("zset", "æå››",3);
      zSetOperations.add("zset", "ç‹äº”",2);
      Set<String> zset = zSetOperations.range("zset", 0, 2);
      return zset;
  }
  ```

+ å“ˆå¸Œ

  é€šè¿‡key

  æ‰¾åˆ°hashmapï¼Œé€šè¿‡hashmapçš„keyæ‰¾åˆ°hashmapçš„valueã€‚

springbootä¸­æ˜¯ç”¨spring-dataæ“ä½œredisçš„ã€‚

### springbootæ•´åˆredisæ­¥éª¤

1. å¯¼åŒ…

   1. spring-boot-starter-redis
   2. spring-boot-starter-data-redis

2. åˆ›å»ºå®ä½“ç±»ï¼Œä¸”**éœ€è¦åºåˆ—åŒ–**ï¼Œå¯åŠ¨redis

3. åˆ›å»ºæ§åˆ¶å™¨

   ```java
   //    @RequestBody æŠŠå®¢æˆ·ç«¯ä¼ è¿‡æ¥çš„jsonå¯¹è±¡è½¬åŒ–ä¸ºjavaå¯¹è±¡
   ```

   é€šè¿‡

   ```java
   @Autowired
   private RedisTemplate redisTemplate;
   ```

   å¯¹è±¡æ¥æ“ä½œredis.

4. åˆ›å»ºé…ç½®æ–‡ä»¶

```yml
spring:
  redis:
    host: localhost
#    0è¡¨ç¤ºç”¨ä»–è‡ªå·±çš„æ•°æ®åº“ï¼Œç»Ÿä¸€çš„æ•°æ®åº“
    database: 0
    port: 6379  
```

## lambdaè¡¨è¾¾å¼

+ å¸¦å‚æ•°å˜é‡çš„è¡¨è¾¾å¼æˆä¸ºlambda
+ æ˜¯ä¸€ä¸ªå¯ä¼ é€’çš„ä»£ç å—ï¼Œå¯åœ¨ä»¥åæ‰§è¡Œä¸€æ¬¡æˆ–å¤šæ¬¡
+ `(å‚æ•°) -> {ä»£ç åŒºåŸŸ}`
+ å¦‚æœå‚æ•°åªæœ‰ä¸€ä¸ªä¸”å¯æ¨å¯¼å‡ºå…¶ç±»å‹ï¼Œå¯çœç•¥æ‹¬å·()
+ æ— éœ€æŒ‡å®šlambdaè¡¨è¾¾å¼çš„è¿”å›å€¼ï¼Œå®ƒæ€»æ˜¯å¯ä»¥ç”±ä¸Šä¸‹æ–‡æ¨å¯¼

---

###  å‡½æ•°å¼æ¥å£

+ åªæœ‰ä¸€ä¸ªæŠ½è±¡æ–¹æ³•çš„æ¥å£ï¼Œå¯æä¾›lambdaè¡¨è¾¾å¼ï¼Œæˆä¸ºå‡½æ•°å¼æ¥å£
+ lambdaè¡¨è¾¾å¼å¯è½¬æ¢ä¸ºæ¥å£
+ æƒ³è¦lambdaè¡¨è¾¾å¼åšæŸäº›å¤„ç†ï¼Œä¸ºå®ƒå»ºç«‹ä¸€ä¸ªç‰¹å®šçš„å‡½æ•°å¼æ¥å£

### æ–¹æ³•å¼•ç”¨

ç”¨`::`åˆ†å‰²æ–¹æ³•åä¸å¯¹è±¡æˆ–ç±»å

+ object::instanceMethod

  ï¼ˆå·¦ä¾§ä¸ºå¯¹è±¡ï¼Œå³ä¾§ä¸ºå®ä¾‹æ–¹æ³•ï¼‰ç­‰ä»·äºå‘æ–¹æ³•ä¼ é€’å‚æ•°çš„lambdaè¡¨è¾¾å¼ã€‚å¦‚ `System.out::println`

  `x -> System.out.println(x)`

  + å’Œlambdaè¡¨è¾¾å¼æœ‰ç»†å¾®å·®åˆ«

    è‹¥å¯¹è±¡ä¸ºnullï¼Œlambdaåªåœ¨è°ƒç”¨æ—¶æŠ›å‡ºå¼‚å¸¸

+ Class::instanceMethod

  ï¼ˆå·¦ä¾§ä¸ºç±»ï¼Œå³ä¾§ä¸ºå®ä¾‹æ–¹æ³•ï¼‰ç¬¬ä¸€ä¸ªå‚æ•°ä¼šæˆä¸ºæ–¹æ³•çš„éšå¼å‚æ•°

  å¦‚`String::compareToIgnoreCase`ç­‰åŒäº

  `(x,y) - > x.compareToIgnoreCase(y)`

+ Class::staticMethod

  ï¼ˆå·¦ä¾§ä¸ºç±»ï¼Œå³ä¾§ä¸ºé™æ€æ–¹æ³•ï¼‰æ‰€æœ‰å‚æ•°éƒ½ä¼ é€’åˆ°é™æ€æ–¹æ³•

  å¦‚`Math::pow`ç­‰ä»·äº 

  `(x,y) -> Math.pow(x,y)`

## gitç”¨æ³•

+ è¿›å…¥xxxæ–‡ä»¶å¤¹ï¼Œæ‰§è¡ŒæŒ‡ä»¤ `git init`
+ æ‰§è¡ŒæŒ‡ä»¤`git add .`ï¼Œ`.`è¡¨ç¤ºå½“å‰è·¯å¾„ï¼Œå°†æ‰€æœ‰æ–‡ä»¶æ·»åŠ åˆ°ä»“åº“
+ `git remote add origin sshåœ°å€`
+ æ‰§è¡ŒæŒ‡ä»¤ï¼š`git commit -m "æ³¨é‡Š"` åŒå¼•å·å†…ä¸ºæ³¨é‡Šï¼Œæäº¤æ–‡ä»¶
+ `git push -u origin master`

## PageHelper

